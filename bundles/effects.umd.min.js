/**
 * @license NgRx 8.0.0-beta.2
 * (c) 2015-2018 Brandon Roberts, Mike Ryan, Rob Wormald, Victor Savkin
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("@ngrx/store"),require("rxjs"),require("rxjs/operators"),require("@angular/core")):"function"==typeof define&&define.amd?define("@ngrx/effects",["exports","tslib","@ngrx/store","rxjs","rxjs/operators","@angular/core"],t):t(((e=e||self).ngrx=e.ngrx||{},e.ngrx.effects={}),e.tslib,e["@ngrx/store"],e.rxjs,e.rxjs.operators,e.ng.core)}(this,function(e,t,r,n,o,i){"use strict";var c="__@ngrx/effects_create__";function f(e){return Object.getOwnPropertyNames(e).filter(function(t){return e[t]&&e[t].hasOwnProperty(c)}).map(function(r){return t.__assign({propertyName:r},e[r][c])})}function a(e){return Object.getPrototypeOf(e)}var u="__@ngrx/effects__";function s(e){return r.compose(p,a)(e)}function p(e){return e.constructor.hasOwnProperty(u)?e.constructor[u]:[]}function d(e){return[s,f].reduce(function(t,r){return t.concat(r(e))},[])}function _(e){var r=a(e).constructor.name,i=d(e).map(function(t){var n=t.propertyName,i=t.dispatch,c="function"==typeof e[n]?e[n]():e[n];return!1===i?c.pipe(o.ignoreElements()):c.pipe(o.materialize()).pipe(o.map(function(t){return{effect:e[n],notification:t,propertyName:n,sourceName:r,sourceInstance:e}}))});return n.merge.apply(void 0,t.__spread(i))}var l=function(e){function o(t){var r=e.call(this)||this;return t&&(r.source=t),r}var c;return t.__extends(o,e),c=o,o.prototype.lift=function(e){var t=new c;return t.source=this,t.operator=e,t},c=t.__decorate([i.Injectable(),t.__param(0,i.Inject(r.ScannedActionsSubject)),t.__metadata("design:paramtypes",[n.Observable])],o)}(n.Observable),y="ngrxOnIdentifyEffects",m="ngrxOnRunEffects",g=function(e){function n(t,r){var n=e.call(this)||this;return n.errorHandler=t,n.store=r,n}return t.__extends(n,e),n.prototype.addEffects=function(e){this.next(e),"ngrxOnInitEffects"in e&&"function"==typeof e.ngrxOnInitEffects&&this.store.dispatch(e.ngrxOnInitEffects())},n.prototype.toActions=function(){var e=this;return this.pipe(o.groupBy(a),o.mergeMap(function(e){return e.pipe(o.groupBy(h))}),o.mergeMap(function(t){return t.pipe(o.exhaustMap(v),o.map(function(t){return function r(e,t){!function r(e,t){"E"===e.notification.kind&&t.handleError(e.notification.error)}(e,t),function n(e,t){if("N"===e.notification.kind){var r=e.notification.value;!function n(e){return e&&e.type&&"string"==typeof e.type}(r)&&t.handleError(new Error("Effect "+function o(e){var t=e.propertyName;return'"'+e.sourceName+"."+t+("function"==typeof e.sourceInstance[t]?"()":"")+'"'}(e)+" dispatched an invalid action: "+function i(e){try{return JSON.stringify(e)}catch(t){return e}}(r)))}}(e,t)}(t,e.errorHandler),t.notification}),o.filter(function(e){return"N"===e.kind}),o.dematerialize())}))},t.__decorate([i.Injectable(),t.__metadata("design:paramtypes",[i.ErrorHandler,r.Store])],n)}(n.Subject);function h(e){return y in e&&"function"==typeof e[y]?e[y]():""}function v(e){var t=_(e);return function r(e){var t=a(e);return m in t&&"function"==typeof t[m]}(e)?e.ngrxOnRunEffects(t):t}new i.InjectionToken("ngrx/effects: Immediate Effects");var x=new i.InjectionToken("ngrx/effects: Root Effects"),E=new i.InjectionToken("ngrx/effects: Feature Effects"),b=function(){function e(e,t){this.effectSources=e,this.store=t,this.effectsSubscription=null}return e.prototype.start=function(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))},e.prototype.ngOnDestroy=function(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)},t.__decorate([i.Injectable(),t.__metadata("design:paramtypes",[g,r.Store])],e)}(),O="@ngrx/effects/init",j=function(){function e(e,t,r,n,o,i){this.sources=e,t.start(),n.forEach(function(t){return e.addEffects(t)}),r.dispatch({type:O})}return e.prototype.addEffects=function(e){this.sources.addEffects(e)},t.__decorate([i.NgModule({}),t.__param(3,i.Inject(x)),t.__param(4,i.Optional()),t.__param(5,i.Optional()),t.__metadata("design:paramtypes",[g,b,r.Store,Array,r.StoreRootModule,r.StoreFeatureModule])],e)}(),N=function(){return t.__decorate([i.NgModule({}),t.__param(1,i.Inject(E)),t.__param(2,i.Optional()),t.__param(3,i.Optional()),t.__metadata("design:paramtypes",[j,Array,r.StoreRootModule,r.StoreFeatureModule])],function e(t,r,n,o){r.forEach(function(e){return e.forEach(function(e){return t.addEffects(e)})})})}(),S=function(){function e(){}return e.forFeature=function(e){return{ngModule:N,providers:[e,{provide:E,multi:!0,deps:e,useFactory:I}]}},e.forRoot=function(e){return{ngModule:j,providers:[b,g,l,e,{provide:x,deps:e,useFactory:I}]}},t.__decorate([i.NgModule({})],e)}();function I(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}e.ɵngrx_modules_effects_effects_c=N,e.ɵngrx_modules_effects_effects_a=I,e.ɵngrx_modules_effects_effects_b=j,e.ɵngrx_modules_effects_effects_f=b,e.ɵngrx_modules_effects_effects_e=E,e.ɵngrx_modules_effects_effects_d=x,e.createEffect=function M(e,t){var r=(void 0===t?{}:t).dispatch,n=void 0===r||r,o=e();return Object.defineProperty(o,c,{value:{dispatch:n}}),o},e.Effect=function w(e){var t=(void 0===e?{}:e).dispatch,r=void 0===t||t;return function(e,t){!function n(e,t){var r=e.constructor,n=r.hasOwnProperty(u)?r[u]:Object.defineProperty(r,u,{value:[]})[u];Array.prototype.push.apply(n,t)}(e,[{propertyName:t,dispatch:r}])}},e.getEffectsMetadata=function T(e){var r,n,o={};try{for(var i=t.__values(d(e)),c=i.next();!c.done;c=i.next()){var f=c.value;o[f.propertyName]={dispatch:f.dispatch}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},e.mergeEffects=_,e.Actions=l,e.ofType=function R(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.filter(function(t){return e.some(function(e){return"string"==typeof e?e===t.type:e.type===t.type})})},e.EffectsModule=S,e.EffectSources=g,e.ROOT_EFFECTS_INIT=O,e.mapToAction=function P(e,r){var i="function"==typeof e?{project:e,error:r,operator:o.concatMap,complete:void 0,unsubscribe:void 0}:t.__assign({},e,{operator:e.operator||o.concatMap}),c=i.project,f=i.error,a=i.complete,u=i.operator,s=i.unsubscribe;return function(e){return n.defer(function(){var t=new n.Subject;return n.merge(e.pipe(u(function(e,r){return n.defer(function(){var i=!1,u=!1,p=0;return c(e,r).pipe(o.materialize(),o.map(function(t){switch(t.kind){case n.NotificationKind.ERROR:return u=!0,new n.Notification(n.NotificationKind.NEXT,f(t.error,e));case n.NotificationKind.COMPLETE:return i=!0,a?new n.Notification(n.NotificationKind.NEXT,a(p,e)):void 0;default:return++p,t}}),o.filter(function(e){return null!=e}),o.dematerialize(),o.finalize(function(){i||u||!s||t.next(s(p,e))}))})})),t)})}},Object.defineProperty(e,"__esModule",{value:!0})});