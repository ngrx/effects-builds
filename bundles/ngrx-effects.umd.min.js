!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@ngrx/store"),require("rxjs"),require("rxjs/operators"),require("@angular/core")):"function"==typeof define&&define.amd?define("@ngrx/effects",["exports","@ngrx/store","rxjs","rxjs/operators","@angular/core"],e):e(((t=t||self).ngrx=t.ngrx||{},t.ngrx.effects={}),t.store,t.rxjs,t.rxjs.operators,t.ng.core)}(this,(function(t,e,r,n,o){"use strict";var c={dispatch:!0,useEffectsErrorHandler:!0};var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function f(t){return Object.getOwnPropertyNames(t).filter((function(e){return t[e]&&t[e].hasOwnProperty("__@ngrx/effects_create__")})).map((function(e){var r=t[e]["__@ngrx/effects_create__"];return i({propertyName:e},r)}))}function u(t){return Object.getPrototypeOf(t)}var a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(t){return e.compose(l,u)(t)}function p(t){return t.constructor.hasOwnProperty("__@ngrx/effects__")}function l(t){return p(t)?t.constructor["__@ngrx/effects__"]:[]}function d(t){return[s,f].reduce((function(e,r){return e.concat(r(t))}),[])}var y=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,c=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=c.next()).done;)i.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=c.return)&&r.call(c)}finally{if(o)throw o.error}}return i},h=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(y(arguments[e]));return t};function v(t,e,o){var c=u(t).constructor.name,i=d(t).map((function(r){var i=r.propertyName,f=r.dispatch,u=r.useEffectsErrorHandler,a="function"==typeof t[i]?t[i]():t[i],s=u?o(a,e):a;return!1===f?s.pipe(n.ignoreElements()):s.pipe(n.materialize()).pipe(n.map((function(e){return{effect:t[i],notification:e,propertyName:i,sourceName:c,sourceInstance:t}})))}));return r.merge.apply(void 0,h(i))}function g(t,e,r){return void 0===r&&(r=10),t.pipe(n.catchError((function(n){return e&&e.handleError(n),r<=1?t:g(t,e,r-1)})))}var _,E=this&&this.__extends||(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),m=function(t){function n(e){var r=t.call(this)||this;return e&&(r.source=e),r}return E(n,t),n.prototype.lift=function(t){var e=new n;return e.source=this,e.operator=t,e},n.decorators=[{type:o.Injectable}],n.ctorParameters=function(){return[{type:r.Observable,decorators:[{type:o.Inject,args:[e.ScannedActionsSubject]}]}]},n}(r.Observable);function b(t,e){if("N"===t.notification.kind){var r=t.notification.value;!function(t){return"function"!=typeof t&&t&&t.type&&"string"==typeof t.type}(r)&&e.handleError(new Error("Effect "+(o=(n=t).propertyName,c=n.sourceInstance,i=n.sourceName,f="function"==typeof c[o],'"'+i+"."+String(o)+(f?"()":"")+'"')+" dispatched an invalid action: "+function(t){try{return JSON.stringify(t)}catch(e){return t}}(r)))}var n,o,c,i,f}function x(t){return O(t,"ngrxOnInitEffects")}function O(t,e){return t&&e in t&&"function"==typeof t[e]}var j=new o.InjectionToken("@ngrx/effects Internal Root Guard"),w=(new o.InjectionToken("ngrx/effects: Immediate Effects"),new o.InjectionToken("ngrx/effects: User Provided Effects")),S=new o.InjectionToken("ngrx/effects: Internal Root Effects"),I=new o.InjectionToken("ngrx/effects: Root Effects"),M=new o.InjectionToken("ngrx/effects: Internal Feature Effects"),N=new o.InjectionToken("ngrx/effects: Feature Effects"),P=new o.InjectionToken("ngrx/effects: Effects Error Handler"),R=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),F=function(t){function e(e,r){var n=t.call(this)||this;return n.errorHandler=e,n.effectsErrorHandler=r,n}return R(e,t),e.prototype.addEffects=function(t){this.next(t)},e.prototype.toActions=function(){var t=this;return this.pipe(n.groupBy(u),n.mergeMap((function(t){return t.pipe(n.groupBy(T))})),n.mergeMap((function(e){var o=e.pipe(n.exhaustMap((function(e){return(r=t.errorHandler,n=t.effectsErrorHandler,function(t){var e=v(t,r,n);return O(t,"ngrxOnRunEffects")?t.ngrxOnRunEffects(e):e})(e);var r,n})),n.map((function(e){return b(e,t.errorHandler),e.notification})),n.filter((function(t){return"N"===t.kind})),n.dematerialize()),c=e.pipe(n.take(1),n.filter(x),n.map((function(t){return t.ngrxOnInitEffects()})));return r.merge(o,c)})))},e.decorators=[{type:o.Injectable}],e.ctorParameters=function(){return[{type:o.ErrorHandler},{type:void 0,decorators:[{type:o.Inject,args:[P]}]}]},e}(r.Subject);function T(t){return O(t,"ngrxOnIdentifyEffects")?t.ngrxOnIdentifyEffects():""}var k=function(){function t(t,e){this.effectSources=t,this.store=e,this.effectsSubscription=null}return t.prototype.start=function(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))},t.prototype.ngOnDestroy=function(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)},t.decorators=[{type:o.Injectable}],t.ctorParameters=function(){return[{type:F},{type:e.Store}]},t}();var H=e.createAction("@ngrx/effects/init"),A=function(){function t(t,e,r,n,o,c,i){this.sources=t,e.start(),n.forEach((function(e){return t.addEffects(e)})),r.dispatch({type:"@ngrx/effects/init"})}return t.prototype.addEffects=function(t){this.sources.addEffects(t)},t.decorators=[{type:o.NgModule,args:[{}]}],t.ctorParameters=function(){return[{type:F},{type:k},{type:e.Store},{type:Array,decorators:[{type:o.Inject,args:[I]}]},{type:e.StoreRootModule,decorators:[{type:o.Optional}]},{type:e.StoreFeatureModule,decorators:[{type:o.Optional}]},{type:void 0,decorators:[{type:o.Optional},{type:o.Inject,args:[j]}]}]},t}();var V=function(){function t(t,e,r,n){e.forEach((function(e){return e.forEach((function(e){return t.addEffects(e)}))}))}return t.decorators=[{type:o.NgModule,args:[{}]}],t.ctorParameters=function(){return[{type:A},{type:Array,decorators:[{type:o.Inject,args:[N]}]},{type:e.StoreRootModule,decorators:[{type:o.Optional}]},{type:e.StoreFeatureModule,decorators:[{type:o.Optional}]}]},t}(),z=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},q=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,c=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=c.next()).done;)i.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=c.return)&&r.call(c)}finally{if(o)throw o.error}}return i},C=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(q(arguments[e]));return t},D=function(){function t(){}return t.forFeature=function(t){return void 0===t&&(t=[]),{ngModule:V,providers:[t,{provide:M,multi:!0,useValue:t},{provide:w,multi:!0,useValue:[]},{provide:N,multi:!0,useFactory:B,deps:[o.Injector,M,w]}]}},t.forRoot=function(t){return void 0===t&&(t=[]),{ngModule:A,providers:[{provide:j,useFactory:U,deps:[[k,new o.Optional,new o.SkipSelf]]},{provide:P,useValue:g},k,F,m,t,{provide:S,useValue:[t]},{provide:w,multi:!0,useValue:[]},{provide:I,useFactory:B,deps:[o.Injector,S,w]}]}},t.decorators=[{type:o.NgModule,args:[{}]}],t}();function B(t,e,r){var n,o,c,i,f=[];try{for(var u=z(e),a=u.next();!a.done;a=u.next()){var s=a.value;f.push.apply(f,C(s))}}catch(t){n={error:t}}finally{try{a&&!a.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}try{for(var p=z(r),l=p.next();!l.done;l=p.next()){var d=l.value;f.push.apply(f,C(d))}}catch(t){c={error:t}}finally{try{l&&!l.done&&(i=p.return)&&i.call(p)}finally{if(c)throw c.error}}return function(t,e){return e.map((function(e){return t.get(e)}))}(t,f)}function U(t){if(t)throw new TypeError("EffectsModule.forRoot() called twice. Feature modules should use EffectsModule.forFeature() instead.");return"guarded"}var G=this&&this.__assign||function(){return(G=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};t.Actions=m,t.EFFECTS_ERROR_HANDLER=P,t.Effect=function(t){return void 0===t&&(t={}),function(e,r){!function(t,e){p(t)?t.constructor["__@ngrx/effects__"].push(e):Object.defineProperty(t.constructor,"__@ngrx/effects__",{value:[e]})}(e,a(a(a({},c),t),{propertyName:r}))}},t.EffectSources=F,t.EffectsFeatureModule=V,t.EffectsModule=D,t.EffectsRootModule=A,t.EffectsRunner=k,t.ROOT_EFFECTS_INIT="@ngrx/effects/init",t.USER_PROVIDED_EFFECTS=w,t.act=function(t,e){var o="function"==typeof t?{project:t,error:e,operator:n.concatMap,complete:void 0,unsubscribe:void 0}:G(G({},t),{operator:t.operator||n.concatMap}),c=o.project,i=o.error,f=o.complete,u=o.operator,a=o.unsubscribe;return(function(t){return r.defer((function(){var e=new r.Subject;return r.merge(t.pipe(u((function(t,o){return r.defer((function(){var u=!1,s=!1,p=0;return c(t,o).pipe(n.materialize(),n.map((function(e){switch(e.kind){case"E":return s=!0,new r.Notification("N",i(e.error,t));case"C":return u=!0,f?new r.Notification("N",f(p,t)):void 0;default:return++p,e}})),n.filter((function(t){return null!=t})),n.dematerialize(),n.finalize((function(){u||s||!a||e.next(a(p,t))})))}))}))),e)}))})},t.createEffect=function(t,e){var r=t(),n=i(i({},c),e);return Object.defineProperty(r,"__@ngrx/effects_create__",{value:n}),r},t.defaultEffectsErrorHandler=g,t.getEffectsMetadata=function(t){return d(t).reduce((function(t,e){var r=e.propertyName,n=e.dispatch,o=e.useEffectsErrorHandler;return t[r]={dispatch:n,useEffectsErrorHandler:o},t}),{})},t.mergeEffects=v,t.ofType=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.filter((function(e){return t.some((function(t){return"string"==typeof t?t===e.type:t.type===e.type}))}))},t.rootEffectsInit=H,t.ɵa=d,t.ɵb=B,t.ɵc=U,t.ɵd=j,t.ɵe=S,t.ɵf=I,t.ɵg=M,t.ɵh=N,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngrx-effects.umd.min.js.map